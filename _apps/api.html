---
layout: wide
title: Testing Wiless Cellular Library API
<!-- img:   -->
---



<script type="module">
import {Runtime, Inspector} from "https://cdn.jsdelivr.net/npm/@observablehq/runtime@4/dist/runtime.js";
import define from "https://api.observablehq.com/@wiless/cellular-network-simulator.js?v=3";
const inspect = Inspector.into("#observablehq-024a3f53"); 
const inspect2 = Inspector.into("#observablehq-fad0a867");
document.getElementById("update").onclick=hello;
document.getElementById("radius").onchange=hello;
 
  
var cmodule=(new Runtime).module(define, name => {
  if (name === "Circle"){
    console.log("Circle loaded..");
    return inspect();
  }
  if (name === "hexplot"){
    console.log("Hexplot loaded..");
    return inspect2();
  }
  return undefined;
}
  );
//var cmodule2=(new Runtime).module(define, name => name === "hexplot" ? inspect2() : undefined);

  function hello() {
    var myradius=Number(document.getElementById("radius").value);
   //  console.log("Some Global Variable ", someglobalvar);
//     console.log("Hello : radius ",radius,cmodule);
    cmodule.redefine("radius", myradius);
  }
  
</script>
 
  <div class="jumbotron text-center">
    <h1>Experimental Page for Testing API</h1>
    <img id="profile" src="" class="rounded-circle" alt="Profile Picture">
<!--     <button class="btn btn-info xg-signin" data-onsuccess="onSignIn">G Sign</button> -->
<!--     <button class="btn btn-info" onclick="signIn()">Sign In</button> -->
<!--     <button type="button" onclick="signOut();" class="btn btn-info">Sign Out</button> -->
   <form>
          Enter name: 
          <input type="text" name="username" id="userid">
          Enter password: 
          <input type="password" name="password" id="password">
          <button type="button" onclick="LoginAPI();" class="btn btn-info">Login In</button>
</form>
   
    <button type="button" onclick="LoginAPI();" class="btn btn-info">Log In (UserName/PassWord)</button>
    <button type="button" onclick="APIlogger(`new`)" class="btn btn-info">Call API</button>
    <button type="button" onclick="APIlogger('hexgrid')" class="btn btn-info">Hex Grid</button>

  </div>

  <div class="container">
    <div class="row">
      <div class="col-sm-4">
       
  
        <div class="form-group">
          <textarea class="form-control" rows="5" id="console"></textarea>
        </div>
      </div>


      <div class="col-sm-4">
        <h3>Test 2</h3>
        <p>Embeding observable modules</p>
<input type="number" name="radius" id="radius" value=100>
<button type="button" id="update" class="btn btn-info">Update</button>
        <div id="observablehq-fad0a867"></div>
        <h4>Heading 4</h4>
        <div id="observablehq-024a3f53"></div>
<h4>Done.</h4>
      </div>
      <div class="col-sm-4">
        <h3>Test 3</h3>
        <p>Experimental zone..</p>
       
      </div>
    </div>
  </div>


  <script>
//     var googleauth;
//     var userprofile;

    function onSignIn(googleUser) {
      userprofile = googleUser.getBasicProfile();

      // The ID token you need to pass to your backend:
      gtoken = googleUser.getAuthResponse().id_token;
     
      // The ID token you need to pass to your backend:
      console.log('ID: ' + userprofile.getId()); // Do not send to your backend! Use an ID token instead.
      console.log('Name: ' + userprofile.getName());
      console.log('Image URL: ' + userprofile.getImageUrl());
      console.log('Email: ' + userprofile.getEmail()); // This is null if the 'email' scope is not present.
      var img = document.getElementById("profile");
      img.setAttribute("src", userprofile.getImageUrl());
   
      // var opts = { "token": gtoken };
      wiless.LoginViaGoogle(gtoken).then(
        console.log("Google Signed In")
      );
      wiless.APIcalls("gcr"); 
     
//     TestSLSservice("/);
      
    }
 function TestSLSservice(path){
  id_token=gtoken;
  console.log("Trying ...SLS service");
//   apiurl="https://gcr.sendildevar.in";
  apiurl="https://slsservice-4d7hbjhtaq-de.a.run.app";
  
//   path="/";
  
  method="get";
  headers = { 'Authorization': "Bearer " + id_token };
  return fetch(apiurl + path, {
      method: method,
      headers: headers
      //body: JSON.stringify(data)
    }).then(function (resp) {
      console.log("fetch : status", resp.status);
      return resp.json();
    }).then(function (rdata) {
      console.log(method, ":", path, '=>', rdata);      
      return rdata;
    });
 }
    
    function initBackend() {
      console.log("Initialize Backend API Server");
    }

    var someglobalvar;
    function initapi() {
      someglobalvar="Sendil knows it";
      console.log("Loaded Google Platform Library");
    }
    
    function APIlogger(arg) {
      wiless.APIcalls(arg).then(
        d => {
          elem = document.getElementById("console");
          if (elem != null) {
            elem.value = JSON.stringify(d);
          }
        }

      );
    }
//     function signIn() {
//       //{prompt:"select_account"}
//       googleauth.signIn().then(
//         guser => {
//           onSignIn(guser);
//         }
//       );
//     }
//     function initgapi() {
//       console.log("Loaded Google Platform Library");
//       gapi.load('auth2', function () {
//         /* Ready. Make a call to gapi.auth2.init or some other API */        
//         var param = { client_id: '565126014426-fis7623ann950k0i711upje0o5kt3qhp.apps.googleusercontent.com' };
//         googleauth = gapi.auth2.init(param);
//         googleauth.then(
//           d => {
//             initBackend();
//             console.log("Google Auth is ready")
//           }, e => console.log("Error ", e)
//         );

//       });
//     }

    var result = [];
    var cnt = 0;
    
    
    function OnSuccessAPI(d) {
      console.log("Login to API server success. ");
    }
   
   
    function LoginAPI() {
      
      password=document.getElementById("password").value;
      userid=document.getElementById("userid").value;
      
      creds = { userid: userid, password: password };
      wiless.APIcalls("login", creds).then(OnSuccessAPI);
    }

   
//     function signOut() {
//        var auth2 = gapi.auth2.getAuthInstance();
// googleauth.signOut();
// wiless.Logout();
//       //wiless.APIcalls("logout").then(console.log("Logged out Wiless API"));
//     }

</script>
